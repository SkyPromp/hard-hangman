<html>
  <head>
    <title>Galgje</title>
  </head>
  <body>

    <script>

          var mistakes = 0;
          var guesses = ""
          var pattern = ""


      // generate table
      let table = document.createElement("TABLE");

      // generate all the buttons
      for(let letter=65;letter<91;letter++) {
        let btn = document.createElement("button");

        btn.innerHTML = String.fromCharCode(letter);
        btn.onclick = function () {

          fetch(`cgi-bin/game.cgi?guesses=${guesses}&pattern=${pattern}&mistakes=${mistakes.toString()}&letter=${btn.textContent}`)
            .then(antwoord => antwoord.json()) // convert response to json
            .then(data => {console.log(data);
                            mistakes = data["mistakes"];
                            guesses = data["guesses"];
                            pattern = data["pattern"];

            });
          let image = document.createElement("IMG");
          image.src = `afbeeldingen/galgje${mistakes}.png`;
          if(document.getElementById("image")){
                      document.body.removeChild(document.getElementById("image"))
          }

          image.id = "image";
          image.align = "center";
          document.body.appendChild(image);

          let pattern_view = document.createElement("p");
          pattern_view.innerHTML = pattern.replaceAll(".", "_ ");
          pattern_view.align = "center";
          if(document.getElementById("pattern")){
            document.body.removeChild(document.getElementById("pattern"))
          }
          pattern_view.id = "pattern"
          //document.body.removeChild()
          document.body.appendChild(pattern_view);

          btn.disabled = true; // disable the button

        };
        table.appendChild(btn)
        let space = document.createElement("span");
        space.innerHTML = " ";
        table.appendChild(space);


        //document.body.appendChild(btn); // send button to the body
        if (letter === 75 || letter === 86){
          table.align = "center";
          document.body.appendChild(table);
          table = document.createElement("TABLE");
          document.body.appendChild(document.createElement("br"));
        }

    }
      table.align = "center";
    document.body.appendChild(table);
    </script>

  </body>
</html>


